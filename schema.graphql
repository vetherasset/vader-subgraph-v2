enum DateType {
  All
  Year
  Month
  Day
  Hour
}

enum ProposalState {
  Pending
  Active
  Canceled
  Defeated
  Succeeded
  Queued
  Expired
  Executed
}

enum BondParameter {
  VESTING,
  PAYOUT,
  DEBT
}

type Global @entity {
  id: ID!
  name: String!
  value: String!
  type: DateType
  timestamp: Int
}

type Allowance @entity {
  id: ID!
  token: Token!
  owner: Account!
  spender: Account!
  amount: BigInt!
}

type Balance @entity {
  id: ID!
  account: Account!
  token: Token!
  balance: BigInt!
}

type Account @entity {
  id: ID!
  index: Int!
  address: Bytes!
  updatedAt: Int
  isUntaxed: Boolean!
  isBondContract: Boolean!
  token: [Balance]! @derivedFrom(field: "account")
  nft: [NFTItem]! @derivedFrom(field: "owner")
  allowance: [Allowance]! @derivedFrom(field: "owner")
  nftAllowance: [NFTAllowance]! @derivedFrom(field: "owner")
  vest: [Vest]! @derivedFrom(field: "account")
  bondInfo: [Bond]! @derivedFrom(field: "bond")
  bondDepositorInfo: [Bond]! @derivedFrom(field: "depositor")
  bondTerms: [Terms]! @derivedFrom(field: "bond")
  bondAdjust: [Adjust]! @derivedFrom(field: "bond")
  burnSenderEvent: [BurnEvent]! @derivedFrom(field: "sender")
  burnToEvent: [BurnEvent]! @derivedFrom(field: "to")
  mintSenderEvent: [MintEvent]! @derivedFrom(field: "sender")
  mintToEvent: [MintEvent]! @derivedFrom(field: "to")
  proposal: [Proposal]! @derivedFrom(field: "proposer")
  receipt: [Receipt]! @derivedFrom(field: "voter")
  bondCreatedEvent: [BondCreatedEvent]! @derivedFrom(field: "bond")
  bondRedeemedEvent: [BondRedeemedEvent]! @derivedFrom(field: "bond")
  bondPriceChangedEvent: [BondPriceChangedEvent]! @derivedFrom(field: "bond")
  bondControlVariableAdjustmentEvent: [ControlVariableAdjustmentEvent]! @derivedFrom(field: "bond")
  bondSetBondTermsEvent: [SetBondTermsEvent]! @derivedFrom(field: "bond")
  bondSetAdjustmentEvent: [SetAdjustmentEvent]! @derivedFrom(field: "bond")
  bondTreasuryChangedEvent: [TreasuryChangedEvent]! @derivedFrom(field: "bond")
  bondRedeemedRecipientEvent: [BondRedeemedEvent]! @derivedFrom(field: "recipient")
  conversionEvent: [ConversionEvent]! @derivedFrom(field: "user")
  councilChangedOldEvent: [CouncilChangedEvent]! @derivedFrom(field: "oldCouncil")
  councilChangedNewEvent: [CouncilChangedEvent]! @derivedFrom(field: "newCouncil")
  feeReceiverChangedOldEvent: [FeeReceiverChangedEvent]! @derivedFrom(field: "oldFeeReceiver")
  feeReceiverChangedNewEvent: [FeeReceiverChangedEvent]! @derivedFrom(field: "newFeeReceiver")
  grantClaimedEvent: [GrantClaimedEvent]! @derivedFrom(field: "beneficiary")
  grantDistributedEvent: [GrantDistributedEvent]! @derivedFrom(field: "recipient")
  lossCoveredEvent: [LossCoveredEvent]! @derivedFrom(field: "recipient")
  newAdminEvent: [NewAdminEvent]! @derivedFrom(field: "newAdmin")
  newPendingAdminEvent: [NewPendingAdminEvent]! @derivedFrom(field: "newPendingAdmin")
  positionOpenedFromEvent: [PositionOpenedEvent]! @derivedFrom(field: "from")
  positionOpenedToEvent: [PositionOpenedEvent]! @derivedFrom(field: "to")
  positionClosedEvent: [PositionClosedEvent]! @derivedFrom(field: "sender")
  proposalCreatedEvent: [ProposalCreatedEvent]! @derivedFrom(field: "proposer")
  setBondContractEvent: [SetBondContractEvent]! @derivedFrom(field: "bond")
  treasuryChangedEvent: [TreasuryChangedEvent]! @derivedFrom(field: "treasury")
  withdrawEvent: [WithdrawEvent]! @derivedFrom(field: "destination")
  approveOwnerEvent: [ApprovalEvent]! @derivedFrom(field: "owner")
  approveSpenderEvent: [ApprovalEvent]! @derivedFrom(field: "spender")
  receiveEvent: [TransferEvent]! @derivedFrom(field: "to")
  sendEvent: [TransferEvent]! @derivedFrom(field: "from")
  swapSenderEvent: [SwapEvent]! @derivedFrom(field: "sender")
  swapToEvent: [SwapEvent]! @derivedFrom(field: "to")
  vestedEvent: [VestedEvent]! @derivedFrom(field: "from")
}

# ======================== Token ========================
type Token @entity {
  id: ID!
  address: Bytes!
  totalSupply: BigInt!
  isSupported: Boolean!
  isSynth: Boolean!
  synth: Bytes
  holder: [Balance]! @derivedFrom(field: "token")
  nftHolder: [NFTItem]! @derivedFrom(field: "token")
  allowance: [Allowance]! @derivedFrom(field: "token")
  nftAllowance: [NFTAllowance]! @derivedFrom(field: "token")
  foreignAssetPosition: [Position]! @derivedFrom(field: "foreignAsset")
  pairInfo: [PairInfo]! @derivedFrom(field: "foreignAsset")
  swapEvent: [SwapEvent]! @derivedFrom(field: "foreignAsset")
  syncEvent: [SyncEvent]! @derivedFrom(field: "foreignAsset")
  withdrawEvent: [WithdrawEvent]! @derivedFrom(field: "token")
  transferEvent: [TransferEvent]! @derivedFrom(field: "token")
  approvalEvent: [ApprovalEvent]! @derivedFrom(field: "token")
}

type ApprovalEvent @entity {
  id: ID!
  token: Token!
  owner: Account!
  spender: Account!
  amount: BigInt!
}

type TransferEvent @entity {
  id: ID!
  token: Token!
  from: Account!
  to: Account!
  value: BigInt!
}

# ======================== Vader ========================
type EmissionEvent @entity {
  id: ID!
  amount: BigInt!
  lastEmission: BigInt!
}

type EmissionChangedEvent @entity {
  id: ID!
  previous: BigInt!
  next: BigInt!
}

type GrantClaimedEvent @entity {
  id: ID!
  beneficiary: Account!
  amount: BigInt!
}

type MaxSupplyChangedEvent @entity {
  id: ID!
  previous: BigInt!
  next: BigInt!
}

type ProtocolInitializedEvent @entity {
  id: ID!
  converter: Bytes!
  vest: Token!
  usdv: Token!
  dao: Bytes!
}

# ======================== USDV =========================

# ====================== Converter ======================
type ConversionEvent @entity {
  id: ID!
  user: Account!
  vetherAmount: BigInt!
  vaderAmount: BigInt!
}

# ==================== VaderReserve ======================
type GrantDistributedEvent @entity {
  id: ID!
  recipient: Account!
  amount: BigInt!
}

type LossCoveredEvent @entity {
  id: ID!
  recipient: Account!
  amount: BigInt!
}

# ===================== VaderPoolV2 ========================
type NFTApproval @entity {
  id: ID!
  token: Token!
  owner: Account!
  operator: Account!
  approved: Boolean!
}

type NFTAllowance @entity {
  id: ID!
  token: Token!
  owner: Account!
  spender: Account!
  tokenId: BigInt!
}

type NFTItem @entity {
  id: ID!
  owner: Account!
  token: Token!
  tokenId: BigInt!
  position: [Position]! @derivedFrom(field: "nftItem")
}

type Position @entity {
  id: ID!
  foreignAsset: Token!
  creation: BigInt!
  liquidity: BigInt!
  originalNative: BigInt!
  originalForeign: BigInt!
  nftItem: NFTItem!
  isDeleted: Boolean!
}

type PairInfo @entity {
  id: ID!
  foreignAsset: Token!
  totalSupply: BigInt!
  reserveNative: BigInt!
  reserveForeign: BigInt!
  blockTimestampLast: BigInt!
  nativeLast: BigInt!
  foreignLast: BigInt!
}

type BurnEvent @entity {
  id: ID!
  sender: Account!
  amount0: BigInt!
  amount1: BigInt!
  to: Account!
}

type MintEvent @entity {
  id: ID!
  sender: Account!
  to: Account!
  amount0: BigInt!
  amount1: BigInt!
}

type PositionOpenedEvent @entity {
  id: ID!
  from: Account!
  to: Account!
  index: BigInt!
  liquidity: BigInt!
}

type PositionClosedEvent @entity {
  id: ID!
  sender: Account!
  index: BigInt!
  liquidity: BigInt!
  loss: BigInt!
}

type QueueActiveEvent @entity {
  id: ID!
  activated: Boolean!
}

type SwapEvent @entity {
  id: ID!
  foreignAsset: Token!
  sender: Account!
  amount0In: BigInt!
  amount1In: BigInt!
  amount0Out: BigInt!
  amount1Out: BigInt!
  to: Account!
}

type SyncEvent @entity {
  id: ID!
  foreignAsset: Token!
  reserve0: BigInt!
  reserve1: BigInt!
}

# ===================== Treasury =========================
type SetBondContractEvent @entity {
  id: ID!
  bond: Account!
  approved: Boolean!
}

type WithdrawEvent @entity {
  id: ID!
  token: Token!
  destination: Account!
  amount: BigInt!
}

# ===================== VaderBond ========================
type Terms @entity {
  id: ID!
  bond: Account!
  controlVariable: BigInt!
  vestingTerm: BigInt!
  minPrice: BigInt!
  maxPayout: BigInt!
  maxDebt: BigInt!
}

type Adjust @entity {
  id: ID!
  bond: Account!
  add: Boolean!
  rate: BigInt!
  target: BigInt!
  buffer: BigInt!
  lastBlock: BigInt!
}

type Bond @entity {
  id: ID!
  bond: Account!
  depositor: Account!
  payout: BigInt!
  vesting: BigInt!
  lastBlock: BigInt!
}

type BondCreatedEvent @entity {
  id: ID!
  bond: Account!
  deposit: BigInt!
  payout: BigInt!
  expires: BigInt!
}

type BondRedeemedEvent @entity {
  id: ID!
  bond: Account!
  recipient: Account!
  payout: BigInt!
  remaining: BigInt!
}

type BondPriceChangedEvent @entity {
  id: ID!
  bond: Account!
  internalPrice: BigInt!
  debtRatio: BigInt!
}

type ControlVariableAdjustmentEvent @entity {
  id: ID!
  bond: Account!
  initialBCV: BigInt!
  newBCV: BigInt!
  adjustment: BigInt!
  addition: Boolean!
}

type SetBondTermsEvent @entity {
  id: ID!
  bond: Account!
  param: BondParameter!
  input: BigInt!
}

type SetAdjustmentEvent @entity {
  id: ID!
  bond: Account!
  add: Boolean!
  rate: BigInt!
  target: BigInt!
  buffer: BigInt!
}

type TreasuryChangedEvent @entity {
  id: ID!
  bond: Account!
  treasury: Account!
}

# =================== LinearVesting ======================
type Vest @entity {
  id: ID!
  account: Account!
  amount: BigInt!
  lastClaim: BigInt!
  start: BigInt!
  end: BigInt!
}

type VestedEvent @entity {
  id: ID!
  from: Account!
  amount: BigInt!
}

type VestingCreatedEvent @entity {
  id: ID!
  user: Account!
  amount: BigInt!
}

type VestingInitializedEvent @entity {
  id: ID!
  duration: BigInt!
}

# =================== GovernorAlpha ======================
type Proposal @entity {
  id: ID!
  canceled: Boolean!
  executed: Boolean!
  proposer: Account!
  eta: BigInt!
  targets: [Bytes!]!
  values: [BigInt!]!
  signatures: [String]!
  calldatas: [Bytes!]!
  startBlock: BigInt!
  endBlock: BigInt!
  forVotes: BigInt!
  againstVotes: BigInt!
  vetoStatus: VetoStatus
  receipt: [Receipt]! @derivedFrom(field: "proposal")
}

type VetoStatus @entity {
  id: ID!
  hasBeenVetoed: Boolean!
  support: Boolean!
}

type Receipt @entity {
  id: ID!
  proposal: Proposal!
  voter: Account!
  hasVoted: Boolean!
  support: Boolean!
  votes: BigInt!
}

type CouncilChangedEvent @entity {
  id: ID!
  oldCouncil: Account!
  newCouncil: Account!
}

type FeeReceiverChangedEvent @entity {
  id: ID!
  oldFeeReceiver: Account!
  newFeeReceiver: Account!
}

type FeeAmountChangedEvent @entity {
  id: ID!
  oldFeeAmount: BigInt!
  newFeeAmount: BigInt!
}

type ProposalCreatedEvent @entity {
  id: ID!
  index: BigInt!
  proposer: Account!
  targets: [Bytes!]!
  values: [BigInt!]!
  signatures: [String]!
  calldatas: [Bytes!]!
  startBlock: BigInt!
  endBlock: BigInt!
  description: String!
}

type ProposalCanceledEvent @entity {
  id: ID!
  proposalId: BigInt!
}

type ProposalQueuedEvent @entity {
  id: ID!
  proposalId: BigInt!
  eta: BigInt!
}

type ProposalExecutedEvent @entity {
  id: ID!
  proposalId: BigInt!
}

type ProposalVetoedEvent @entity {
  id: ID!
  proposalId: BigInt!
  support: Boolean!
}

type VoteCastEvent @entity {
  id: ID!
  voter: Account!
  proposalId: BigInt!
  support: Boolean!
  votes: BigInt!
}
                        
# ===================== Timelock =========================
type QueuedTransaction @entity {
  id: ID!
  status: Boolean!
  cancelTransactionEvent: [CancelTransactionEvent]! @derivedFrom(field: "txHash")
  executeTransactionEvent: [ExecuteTransactionEvent]! @derivedFrom(field: "txHash")
  queueTransactionEvent: [QueueTransactionEvent]! @derivedFrom(field: "txHash")
}

type NewAdminEvent @entity {
  id: ID!
  newAdmin: Account!
}

type NewPendingAdminEvent @entity {
  id: ID!
  newPendingAdmin: Account!
}

type NewDelayEvent @entity {
  id: ID!
  newDelay: BigInt!
}

type CancelTransactionEvent @entity {
  id: ID!
  txHash: QueuedTransaction!
  target: Bytes!
  value: BigInt!
  signature: String!
  data: Bytes!
  eta: BigInt!
}

type ExecuteTransactionEvent @entity {
  id: ID!
  txHash: QueuedTransaction!
  target: Bytes!
  value: BigInt!
  signature: String!
  data: Bytes!
  eta: BigInt!
}

type QueueTransactionEvent @entity {
  id: ID!
  txHash: QueuedTransaction!
  target: Bytes!
  value: BigInt!
  signature: String!
  data: Bytes!
  eta: BigInt!
}
